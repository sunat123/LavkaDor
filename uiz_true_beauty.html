<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞</title>
<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #000;
  overflow: hidden; /* –ó–∞–ø—Ä–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–æ—Ä–ø—É—Å–∞ */
}

.quiz-container {
  width: 100%;
  max-width: 500px; /* –ú–∞–∫—Å–∏–º—É–º 500px –Ω–∞ –ü–ö */
  height: 100vh; /* –†–æ–≤–Ω–æ 100% –≤—ã—Å–æ—Ç—ã –≤–∏–¥–∏–º–æ–π —á–∞—Å—Ç–∏ */
  background: #fff;
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}

/* –®–ê–ü–ö–ê –ö–ê–ù–ê–õ–ê */
.channel-header {
  width: 100%;
  padding: 15px 0;
  background: linear-gradient(135deg, #ff3cac 0%, #784ba0 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  color: #fff;
  z-index: 5;
  flex-shrink: 0;
}

.channel-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.channel-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 2px solid #fff;
  object-fit: cover;
}

.channel-name {
  font-size: 18px;
  font-weight: 800;
}

.btn-subscribe {
  background: #fff;
  color: #ff3cac;
  padding: 6px 15px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: bold;
  border: none;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transition: transform 0.2s;
}
.btn-subscribe:hover { transform: scale(1.05); }

/* –¢–ê–ô–ú–ï–† */
.timer {
  position: absolute;
  top: 95px;
  right: 15px;
  width: 55px;
  height: 55px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 16px;
  color: #fff;
  background: conic-gradient(#ff6aa2 360deg, #b36bff 0deg);
  z-index: 10;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  transition: transform 0.3s ease;
}

/* –ê–ù–ò–ú–ê–¶–ò–Ø –ü–£–õ–¨–°–ê–¶–ò–ò –¢–ê–ô–ú–ï–†–ê */
@keyframes timerPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.low-time-pulse {
  animation: timerPulse 0.5s infinite ease-in-out;
}

.content-area {
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-grow: 1; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
  overflow-y: auto; /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ */
}

.quiz-title {
  font-size: 26px;
  font-weight: 900;
  color: #ff3cac;
  margin: 10px 0;
  flex-shrink: 0;
}

/* –°–¢–ò–õ–¨ –î–õ–Ø –ù–£–ú–ï–†–ê–¶–ò–ò –ù–ê–î –í–û–ü–†–û–°–û–ú */
.question-number {
  font-size: 18px;
  font-weight: 800;
  color: #784ba0;
  background: #f0ebff;
  padding: 4px 12px;
  border-radius: 10px;
  margin-bottom: 8px;
  flex-shrink: 0;
}

/* –≠–§–§–ï–ö–¢ –ú–ò–ì–ê–ù–ò–Ø –ö–£–†–°–û–†A */
@keyframes blinkCaret {
  50% { border-color: transparent; }
}

h3#question {
  display: block;
  white-space: normal;
  margin: 5px auto 20px auto;
  min-height: 60px;
  border-right: 3px solid transparent; 
}

.is-typing {
  border-right: 3px solid #ff3cac !important;
  animation: blinkCaret 0.7s step-end infinite;
}

h3 {
  font-size: 19px;
  color: #444;
  margin-bottom: 20px;
  text-align: center;
  margin-top: 5px;
}

#answers {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
}

/* –ê–ù–ò–ú–ê–¶–ò–Ø –ü–û–î–ü–†–´–ì–ò–í–ê–ù–ò–Ø –ö–ù–û–ü–û–ö */
@keyframes softBounce {
  0% { opacity: 0; transform: translateY(50px); }
  60% { transform: translateY(-10px); }
  100% { opacity: 1; transform: translateY(0); }
}

.answer {
  width: 90%;
  padding: 14px;
  margin: 6px 0;
  font-size: 16px;
  font-weight: 600;
  border-radius: 15px;
  border: none;
  cursor: pointer;
  background: #f8f9fa;
  box-shadow: 0 4px 0 #ddd;
  transition: all 0.2s ease;
  opacity: 0;
  transform: translateY(50px);
  animation-fill-mode: forwards;
}

.correct { background: #33ff00 !important; color: #fff !important; box-shadow: 0 4px 0 #33ff00 !important; }
.wrong { background: #ff1900 !important; color: #fff !important; box-shadow: 0 4px 0 #ff1900 !important; animation: shake 0.4s; }

.progress-bar {
  width: 90%;
  height: 8px;
  background: #eee;
  border-radius: 10px;
  margin-bottom: 15px;
  flex-shrink: 0;
}
.progress-bar-fill {
  height: 100%;
  width: 0%;
  background: #ff3cac;
  border-radius: 10px;
  transition: width 0.5s ease;
}

/* –§–ò–ù–ê–õ–¨–ù–´–ô –≠–ö–†–ê–ù */
.results { 
  display: none; 
  flex-direction: column; 
  align-items: center; 
  width: 100%; 
}

.result-screen {
  width: 100%;
  padding: 25px 15px;
  border-radius: 30px;
  text-align: center;
  color: #fff;
  background: linear-gradient(180deg, #70e1ff 0%, #d83aff 100%);
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  box-sizing: border-box;
}

/* –ê–ù–ò–ú–ê–¶–ò–Ø –ü–û–Ø–í–õ–ï–ù–ò–Ø –≠–õ–ï–ú–ï–ù–¢–û–í –§–ò–ù–ê–õ–ê */
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.btn-cta-main {
  width: 100%;
  height: 56px;
  border-radius: 18px;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  color: #fff;
  font-size: 18px;
  font-weight: 800;
  border: none;
  cursor: pointer;
  margin-top: 20px;
  box-shadow: 0 0 10px #00ffff, 0 0 20px #ff00ff;
  transition: all 0.3s ease;
  animation: fadeUp 0.6s ease forwards;
  animation-delay: 0.2s;
  opacity: 0;
}
.btn-cta-main:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #00ffff, 0 0 30px #ff00ff;
}

.neon-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  width: 100%;
  margin-top: 15px;
  animation: fadeUp 0.6s ease forwards;
  animation-delay: 0.4s;
  opacity: 0;
}

.btn-neon {
  height: 48px;
  border-radius: 14px;
  border: none;
  color: #fff;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s;
}
.btn-neon:active { transform: scale(0.95); }

.btn-purple { background: linear-gradient(135deg, #8a2eff, #c77dff); box-shadow: 0 0 10px #a855f7; }
.btn-gold { background: linear-gradient(135deg, #ffd700, #ff9f00); box-shadow: 0 0 10px #ffd700; }
.btn-cyan { background: linear-gradient(135deg, #00ffcc, #00b3ff); box-shadow: 0 0 10px #00ffff; }

.btn-glass-share {
  width: 100%;
  height: 44px;
  margin-top: 15px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.4);
  border-radius: 15px;
  color: #fff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  animation: fadeUp 0.6s ease forwards;
  animation-delay: 0.6s;
  opacity: 0;
}

.btn-try-again {
  width: 100%;
  margin-top: 15px;
  padding: 15px;
  background: #fff5f8;
  color: #333;
  border: none;
  border-radius: 15px;
  font-size: 18px;
  cursor: pointer;
}

#answersContainer {
  margin-top: 20px;
  display: none;
  flex-direction: column;
  width: 100%;
  padding-bottom: 30px;
}

.answer-block {
  margin-bottom: 12px;
  padding: 15px;
  border-radius: 12px;
  background: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  text-align: left;
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 0.5s ease, transform 0.5s ease;
  color: #333;
}

.show-block { opacity: 1; transform: translateY(0); }
.correct-answer { color: #33ff00; font-weight: bold; }
.wrong-answer { color: #ff1900; font-weight: bold; }

@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

/* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ú–û–î–ê–õ–ö–ò –†–ê–ù–ì–ê */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.8);
  z-index: 100;
  justify-content: center;
  align-items: center;
}
.rank-card {
  width: 300px;
  background: #fff;
  border-radius: 20px;
  padding: 20px;
  text-align: center;
}
.rank-badge {
  font-size: 50px;
  margin-bottom: 10px;
}
.rank-info-text {
  color: #666;
  font-size: 14px;
  margin-bottom: 15px;
}
</style>
</head>
<body>

<div class="quiz-container" id="mainContainer">
  <div class="channel-header">
    <div class="channel-info">
      <img src="images/–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è116_20260113171220.png" alt="LavkaDor" class="channel-avatar">
      <span class="channel-name">LavkaDor</span>
    </div>
    <button class="btn-subscribe" onclick="window.location.href='https://www.tiktok.com/@lavkador?_r=1&_t=ZN-9342zlMnoXO'">+ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
  </div>

  <div class="timer" id="timer"><span id="timeText">30</span></div>

  <div class="content-area">
    <div class="quiz-title">–ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞</div>
    
    <div class="progress-bar">
      <div class="progress-bar-fill" id="progressFill"></div>
    </div>

    <div id="qNumber" class="question-number" style="display:none;"></div>
    <h3 id="question">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
    
    <div id="answers"></div>

    <div class="results" id="results">
      <div class="result-screen">
        <h2 id="congratsTitle">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
        <div style="font-size: 60px; margin: 0;">üèÜ</div>
        
        <p id="userLevel">–†–∞–Ω–≥: –ù–æ–≤–∏—á–æ–∫</p>
        
        <div class="progress-bar" style="background: rgba(255,255,255,0.4); margin: 15px auto; width: 95%;">
          <div class="progress-bar-fill" id="resultProgressFill" style="background: #ff68b4;"></div>
        </div>
        
        <p style="font-size: 20px; font-weight: bold;">–ë–∞–ª–ª—ã: <span id="scoreText">0/20</span></p>
        <p style="font-size: 16px;">–í—Ä–µ–º—è: <span id="timeTaken">0:00</span></p>
        
        <button class="btn-cta-main" onclick="window.location.href='https://www.tiktok.com/@lavkador?_r=1&_t=ZN-9342zlMnoXO'">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ LavkaDor</button>
        
        <div class="neon-grid">
          <button class="btn-neon btn-purple" onclick="restartQuiz()"><span>üîÑ</span><span>–ï—â—ë</span></button>
          <button class="btn-neon btn-gold" onclick="openRankModal()"><span>üèÜ</span><span>–†–∞–Ω–≥</span></button>
          <button class="btn-neon btn-cyan" onclick="showAnswers()"><span>üìä</span><span>–û—Ç–≤–µ—Ç—ã</span></button>
        </div>

        <button class="btn-glass-share" onclick="shareResult()">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</button>
      </div>
      <button class="btn-try-again" onclick="restartQuiz()">–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.</button>
    </div>
    
    <div id="answersContainer"></div>
  </div>
</div>

<div class="modal-overlay" id="rankModal" onclick="this.style.display='none'">
    <div class="rank-card" onclick="event.stopPropagation()">
        <div class="rank-badge" id="modalBadge">üå±</div>
        <h2 id="modalRankName" style="color:#ff3cac; margin:5px 0;">–ù–æ–≤–∏—á–æ–∫</h2>
        <p id="modalRankDesc" class="rank-info-text">¬´–¢—ã —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –ø—É—Ç—å –≤ –º–∏—Ä –¥–æ—Ä–∞–º üå±¬ª</p>
        <hr style="border:0; border-top:1px solid #eee;">
        <div style="text-align:left; font-size:14px; color:#333;">
            <p>ü•á –†–µ–∫–æ—Ä–¥: <b id="bestScore">0/20</b></p>
            <p>‚è± –õ—É—á—à–µ–µ –≤—Ä–µ–º—è: <b id="bestTime">--:--</b></p>
            <p>üîÅ –ü–æ–ø—ã—Ç–æ–∫: <b id="totalAttempts">0</b></p>
        </div>
        <button class="btn-subscribe" style="width:100%; margin-top:10px;" onclick="document.getElementById('rankModal').style.display='none'">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
// ===== –¢–ï–õ–ï–ì–†–ê–ú –ù–ê–°–¢–†–û–ô–ö–ò =====
const TG_TOKEN = "8309830318:AAHoIi3Uc6FHQMTPi1lMLh0WfRzkxwtAARY";
const TG_CHAT_ID = "6095101762";

// ===== –ì–ï–ù–ï–†–ê–¶–ò–Ø ID (–í–∞—à —Ñ–æ—Ä–º–∞—Ç) =====
function getUserId() {
    let id = localStorage.getItem('lavka_user_id');
    if (!id) {
        let count = localStorage.getItem('lavka_user_count') || "0001";
        let date = new Date();
        let day = String(date.getDate()).padStart(2, '0');
        let month = String(date.getMonth() + 1).padStart(2, '0');
        let year = date.getFullYear();
        id = `${count}_${day}_${month}_${year}`;
        localStorage.setItem('lavka_user_id', id);
        let nextCount = String(parseInt(count) + 1).padStart(4, '0');
        localStorage.setItem('lavka_user_count', nextCount);
    }
    return id;
}

// ===== –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• =====
async function sendToTelegram(text) {
    const url = `https://api.telegram.org/bot${TG_TOKEN}/sendMessage`;
    try {
        await fetch(url, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                chat_id: TG_CHAT_ID,
                text: text,
                parse_mode: 'HTML'
            })
        });
    } catch (e) {}
}

const originalQuizData = [
  { question: "–ö–∞–∫ –∑–æ–≤—É—Ç –≥–ª–∞–≤–Ω—É—é –≥–µ—Ä–æ–∏–Ω—é –¥–æ—Ä–∞–º—ã?", options:["–ö–∞–Ω –°—É-–¥–∂–∏–Ω","–ò–º –î–∂—É-–≥—ë–Ω","–ß—É –ì—ë–Ω-—Ö–∏","–õ–∏ –°–æ-—ë–Ω"], correct:1 },
  { question: "–ü–æ—á–µ–º—É –î–∂—É-–≥—ë–Ω –º–µ–Ω—è–µ—Ç —à–∫–æ–ª—É?", options:["–ò–∑-–∑–∞ –ø–µ—Ä–µ–µ–∑–¥–∞","–ò–∑-–∑–∞ –ø–ª–æ—Ö–∏—Ö –æ—Ü–µ–Ω–æ–∫","–ò–∑-–∑–∞ —Ç—Ä–∞–≤–ª–∏","–ò–∑-–∑–∞ –±–æ–ª–µ–∑–Ω–∏"], correct:2 },
  { question: "–ß—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –î–∂—É-–≥—ë–Ω —Å—Ç–∞—Ç—å ¬´–∫—Ä–∞—Å–∏–≤–æ–π¬ª?", options:["–î–∏–µ—Ç–∞","–ü–ª–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è","–ú–∞–∫–∏—è–∂","–ù–æ–≤–∞—è –æ–¥–µ–∂–¥–∞"], correct:2 },
  { question: "–ö—Ç–æ –ø–µ—Ä–≤—ã–º —É–∑–Ω–∞—ë—Ç –Ω–∞—Å—Ç–æ—è—â—É—é –≤–Ω–µ—à–Ω–æ—Å—Ç—å –î–∂—É-–≥—ë–Ω –±–µ–∑ –º–∞–∫–∏—è–∂–∞?", options:["–•–∞–Ω –°–æ-–¥–∂—É–Ω","–ö–∞–Ω –°—É-–¥–∂–∏–Ω","–õ–∏ –°—É-—Ö–æ","–£—á–∏—Ç–µ–ª—å"], correct:2 },
  { question: "–ì–¥–µ –°—É-—Ö–æ –≤–∏–¥–∏—Ç –î–∂—É-–≥—ë–Ω –±–µ–∑ –º–∞–∫–∏—è–∂–∞ –≤–ø–µ—Ä–≤—ã–µ?", options:["–í —à–∫–æ–ª–µ","–í –∫–∏–Ω–æ","–í –º–∞–≥–∞–∑–∏–Ω–µ –∫–æ–º–∏–∫—Å–æ–≤","–í –±–æ–ª—å–Ω–∏—Ü–µ"], correct:2 },
  { question: "–ö–∞–∫–æ–π –∂–∞–Ω—Ä –º—É–∑—ã–∫–∏ –ª—é–±–∏—Ç –•–∞–Ω –°–æ-–¥–∂—É–Ω?", options:["–ö–ª–∞—Å—Å–∏–∫–∞","K-pop","–†–æ–∫","–•–∏–ø-—Ö–æ–ø"], correct:2 },
  { question: "–ö–µ–º –º–µ—á—Ç–∞–µ—Ç —Å—Ç–∞—Ç—å –î–∂—É-–≥—ë–Ω?", options:["–ê–∫—Ç—Ä–∏—Å–æ–π","–í–∏–∑–∞–∂–∏—Å—Ç–æ–º","–£—á–∏—Ç–µ–ª–µ–º","–ú–æ–¥–µ–ª—å—é"], correct:1 },
  { question: "–ö–∞–∫–æ–π –ø—Ä–µ–¥–º–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ –¥–∞—ë—Ç—Å—è –°—É-—Ö–æ?", options:["–ò—Å—Ç–æ—Ä–∏—è","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"], correct:1 },
  { question: "–ü–æ—á–µ–º—É –°—É-—Ö–æ –∑–∞–º–∫–Ω—É—Ç—ã–π?", options:["–ò–∑-–∑–∞ –±–æ–ª–µ–∑–Ω–∏","–ò–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º –≤ —Å–µ–º—å–µ","–ò–∑-–∑–∞ –ø–µ—Ä–µ–µ–∑–¥–∞","–ò–∑-–∑–∞ —à–∫–æ–ª—ã"], correct:1 },
  { question: "–ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç—Ü–æ–º –°—É-—Ö–æ?", options:["–£—á–∏—Ç–µ–ª—å","–í—Ä–∞—á","–ò–∑–≤–µ—Å—Ç–Ω—ã–π –∞–∫—Ç—ë—Ä","–ë–∏–∑–Ω–µ—Å–º–µ–Ω"], correct:2 },
  { question: "–ö–∞–∫ –∑–æ–≤—É—Ç –ª—É—á—à—É—é –ø–æ–¥—Ä—É–≥—É –î–∂—É-–≥—ë–Ω –≤ –Ω–æ–≤–æ–π —à–∫–æ–ª–µ?", options:["–°—É-–∞","–•–µ-–∏–Ω","–°—É-–¥–∂–∏–Ω","–ú–∏-—ë–Ω"], correct:0 },
  { question: "–ö—Ç–æ —Ä–∞–Ω—å—à–µ –¥—Ä—É–∂–∏–ª —Å –°—É-—Ö–æ –∏ –°–æ-–¥–∂—É–Ω–æ–º?", options:["–î–∂—É-–≥—ë–Ω","–°—ç-—ë–Ω","–°—É-–¥–∂–∏–Ω","–£—á–∏—Ç–µ–ª—å"], correct:1 },
  { question: "–ü–æ—á–µ–º—É –ø–æ—Å—Å–æ—Ä–∏–ª–∏—Å—å –°—É-—Ö–æ –∏ –°–æ-–¥–∂—É–Ω?", options:["–ò–∑-–∑–∞ –¥–µ–≤—É—à–∫–∏","–ò–∑-–∑–∞ –¥–µ–Ω–µ–≥","–ò–∑-–∑–∞ —Å–º–µ—Ä—Ç–∏ –¥—Ä—É–≥–∞","–ò–∑-–∑–∞ —à–∫–æ–ª—ã"], correct:2 },
  { question: "–ö–∞–∫–æ–π —Å—Ç—Ä–∞—Ö –µ—Å—Ç—å —É –î–∂—É-–≥—ë–Ω?", options:["–í—ã—Å–æ—Ç—ã","–¢–µ–º–Ω–æ—Ç—ã","–ë—ã—Ç—å —Ä–∞—Å–∫—Ä—ã—Ç–æ–π –±–µ–∑ –º–∞–∫–∏—è–∂–∞","–≠–∫–∑–∞–º–µ–Ω–æ–≤"], correct:2 },
  { question: "–ö–∞–∫ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –î–∂—É-–≥—ë–Ω –≤ –Ω–æ–≤–æ–π —à–∫–æ–ª–µ?", options:["–ü–ª–æ—Ö–æ","–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ","–í—Ä–∞–∂–¥–µ–±–Ω–æ","–° –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ–º"], correct:3 },
  { question: "–ö—Ç–æ —Ä–∞–Ω—å—à–µ –±—ã–ª ¬´–∫–æ—Ä–æ–ª–µ–≤–æ–π –∫—Ä–∞—Å–æ—Ç—ã¬ª —à–∫–æ–ª—ã?", options:["–î–∂—É-–≥—ë–Ω","–°—É-–¥–∂–∏–Ω","–•–µ-–∏–Ω","–°—É-–∞"], correct:1 },
  { question: "–ß—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –°—É-–¥–∂–∏–Ω –æ—Ç –æ–∫—Ä—É–∂–∞—é—â–∏—Ö?", options:["–ù–∞—Å—Ç–æ—è—â–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä","–í–æ–∑—Ä–∞—Å—Ç","–°–µ–º—å—é","–ë–æ–ª–µ–∑–Ω—å"], correct:0 },
  { question: "–ì–¥–µ –î–∂—É-–≥—ë–Ω —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É —Å–ø–æ–∫–æ–π–Ω–æ?", options:["–í —à–∫–æ–ª–µ","–î–æ–º–∞","–í –º–∞–≥–∞–∑–∏–Ω–µ –∫–æ–º–∏–∫—Å–æ–≤","–ù–∞ —É–ª–∏—Ü–µ"], correct:2 },
  { question: "–ö–∞–∫–æ–π —Ñ–∏–ª—å–º –ª—é–±—è—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –î–∂—É-–≥—ë–Ω –∏ –°—É-—Ö–æ?", options:["–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π","–£–∂–∞—Å—ã","–ö–æ–º–µ–¥–∏—è","–ú—É–ª—å—Ç—Ñ–∏–ª—å–º"], correct:1 },
  { question: "–ö—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –î–∂—É-–≥—ë–Ω —Å –º–∞–∫–∏—è–∂–µ–º –≤ –Ω–∞—á–∞–ª–µ?", options:["–ú–∞–º–∞","–ü–æ–¥—Ä—É–≥–∞","–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—É—Ä–æ–∫–∏","–£—á–∏—Ç–µ–ª—å"], correct:2 },
  { question: "–ö–∞–∫ –°–æ-–¥–∂—É–Ω –ø—Ä–æ—è–≤–ª—è–µ—Ç –∑–∞–±–æ—Ç—É –æ –î–∂—É-–≥—ë–Ω?", options:["–î–∞—Ä–∏—Ç –ø–æ–¥–∞—Ä–∫–∏","–ó–∞—â–∏—â–∞–µ—Ç –µ—ë","–ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç","–ü–æ–¥—à—É—á–∏–≤–∞–µ—Ç"], correct:1 },
  { question: "–ö–∞–∫–æ–π —Å—Ç–∏–ª—å —É –°–æ-–¥–∂—É–Ω–∞?", options:["–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π","–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π","–ë—É–Ω—Ç–∞—Ä—Å–∫–∏–π","–î–µ–ª–æ–≤–æ–π"], correct:2 },
  { question: "–ß—Ç–æ —Å–ª—É—á–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç –î–∂—É-–≥—ë–Ω?", options:["–ï—ë –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç","–ï—ë —Å–Ω–æ–≤–∞ –Ω–∞—á–∏–Ω–∞—é—Ç —Ç—Ä–∞–≤–∏—Ç—å","–í—Å–µ –º–æ–ª—á–∞—Ç","–û–Ω–∞ —É–µ–∑–∂–∞–µ—Ç"], correct:1 },
  { question: "–ö—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –î–∂—É-–≥—ë–Ω –≤ —Å–∞–º—ã–π —Ç—Ä—É–¥–Ω—ã–π –º–æ–º–µ–Ω—Ç?", options:["–°—É-–¥–∂–∏–Ω","–°–æ-–¥–∂—É–Ω","–°—É-—Ö–æ","–£—á–∏—Ç–µ–ª—å"], correct:2 },
  { question: "–ü–æ—á–µ–º—É –°—É-—Ö–æ —É–µ–∑–∂–∞–µ—Ç?", options:["–£—á—ë–±–∞","–†–∞–±–æ—Ç–∞","–ë–æ–ª–µ–∑–Ω—å –æ—Ç—Ü–∞","–ò–∑-–∑–∞ –î–∂—É-–≥—ë–Ω"], correct:2 },
  { question: "–ö–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –î–∂—É-–≥—ë–Ω –∫ –∫–æ–Ω—Ü—É –¥–æ—Ä–∞–º—ã?", options:["–°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ–ª–æ–¥–Ω–æ–π","–ü–µ—Ä–µ—Å—Ç–∞—ë—Ç –∫—Ä–∞—Å–∏—Ç—å—Å—è","–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–µ–±—è","–£–µ–∑–∂–∞–µ—Ç"], correct:2 },
  { question: "–ö–∞–∫–æ–π –≥–ª–∞–≤–Ω—ã–π –ø–æ—Å—ã–ª –¥–æ—Ä–∞–º—ã?", options:["–î–µ–Ω—å–≥–∏ –≤–∞–∂–Ω–µ–µ –≤—Å–µ–≥–æ","–í–Ω–µ—à–Ω–æ—Å—Ç—å —Ä–µ—à–∞–µ—Ç –≤—Å—ë","–í–∞–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–µ–±—è","–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –±–æ–ª—å"], correct:2 },
  { question: "–ö—Ç–æ –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å –õ–∏ –°—É-—Ö–æ?", options:["–ß–∞ –´–Ω-—É","–ö–∏–º –°—É-—Ö—ë–Ω","–õ–∏ –ú–∏–Ω-—Ö–æ","–ü–∞–∫ –°–æ-–¥–∂—É–Ω"], correct:0 },
  { question: "–ö—Ç–æ –∏–≥—Ä–∞–µ—Ç –ò–º –î–∂—É-–≥—ë–Ω?", options:["–ê–π—é","–ú—É–Ω –ì–∞-—ë–Ω","–ü–∞–∫ –ú–∏–Ω-—ë–Ω","–ö–∏–º –î–∂–∏-–≤–æ–Ω"], correct:1 },
  { question: "–°–∫–æ–ª—å–∫–æ —Å–µ—Ä–∏–π –≤ –¥–æ—Ä–∞–º–µ?", options:["12","14","16","20"], correct:2 },
  { question: "–ö–∞–∫–æ–π –∂–∞–Ω—Ä —É –¥–æ—Ä–∞–º—ã?", options:["–î–µ—Ç–µ–∫—Ç–∏–≤","–£–∂–∞—Å—ã","–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–µ–¥–∏—è","–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"], correct:2 },
  { question: "–ß—Ç–æ –î–∂—É-–≥—ë–Ω –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –±–æ–∏—Ç—Å—è –ø–æ—Ç–µ—Ä—è—Ç—å?", options:["–î–µ–Ω—å–≥–∏","–î—Ä—É–∑–µ–π","–õ—é–±–æ–≤—å","–°–µ–±—è –Ω–∞—Å—Ç–æ—è—â—É—é"], correct:3 },
  { question: "–ö–∞–∫ –°–æ-–¥–∂—É–Ω –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –°—É-—Ö–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º?", options:["–ù–µ–Ω–∞–≤–∏–¥–∏—Ç","–ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç","–ü—Ä–æ—â–∞–µ—Ç","–ë–æ–∏—Ç—Å—è"], correct:2 },
  { question: "–ö—Ç–æ –ø–µ—Ä–≤—ã–º –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –î–∂—É-–≥—ë–Ω —Ç–∞–∫–æ–π, –∫–∞–∫–∞—è –æ–Ω–∞ –µ—Å—Ç—å?", options:["–ú–∞–º–∞","–°–æ-–¥–∂—É–Ω","–°—É-—Ö–æ","–ü–æ–¥—Ä—É–≥–∏"], correct:2 },
  { question: "–ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –ø–æ–¥–Ω–∏–º–∞–µ—Ç –¥–æ—Ä–∞–º–∞?", options:["–≠–∫–æ–ª–æ–≥–∏—è","–®–∫–æ–ª—å–Ω–æ–µ –Ω–∞—Å–∏–ª–∏–µ","–ü–æ–ª–∏—Ç–∏–∫–∞","–†–∞–±–æ—Ç–∞"], correct:1 },
  { question: "–ß—Ç–æ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –º–∞–∫–∏—è–∂ –≤ –¥–æ—Ä–∞–º–µ?", options:["–û–±–º–∞–Ω","–ó–∞—â–∏—Ç—É","–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å","–ö—Ä–∞—Å–æ—Ç—É"], correct:1 },
  { question: "–ö–∞–∫—É—é —ç–º–æ—Ü–∏—é —á–∞—â–µ –≤—Å–µ–≥–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –î–∂—É-–≥—ë–Ω?", options:["–†–∞–¥–æ—Å—Ç—å","–ì–Ω–µ–≤","–°—Ç—Ä–∞—Ö","–õ—é–±–æ–≤—å"], correct:2 },
  { question: "–ß–µ–º –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –î–∂—É-–≥—ë–Ω –∏ –°—É-—Ö–æ?", options:["–†–∞–∑–ª—É–∫–æ–π","–î—Ä—É–∂–±–æ–π","–û–Ω–∏ –≤–º–µ—Å—Ç–µ","–û—Ç–∫—Ä—ã—Ç—ã–º —Ñ–∏–Ω–∞–ª–æ–º"], correct:2 },
  { question: "–ß—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≥–µ—Ä–æ—è–º –∏—Å—Ü–µ–ª–∏—Ç—å—Å—è?", options:["–í—Ä–µ–º—è","–õ—é–±–æ–≤—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞","–î–µ–Ω—å–≥–∏","–ü–µ—Ä–µ–µ–∑–¥"], correct:1 },
  { question: "–ü–æ—á–µ–º—É –¥–æ—Ä–∞–º–∞ —Ç–∞–∫ –ø–æ–ª—é–±–∏–ª–∞—Å—å –∑—Ä–∏—Ç–µ–ª—è–º?", options:["–ò–∑-–∑–∞ —é–º–æ—Ä–∞","–ò–∑-–∑–∞ –∞–∫—Ç—ë—Ä–æ–≤","–ò–∑-–∑–∞ –∂–∏–∑–Ω–µ–Ω–Ω–æ–π —Ç–µ–º—ã","–í—Å—ë –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ"], correct:3 }
];

let quiz = [];
let currentQuestion = 0, time = 30, timerInterval, score = 0, quizStartTime;
let typingTimer;

function shuffleArray(array) {
  let cur = [...array];
  for (let i = cur.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [cur[i], cur[j]] = [cur[j], cur[i]];
  }
  return cur;
}

function getQuizQuestions(original) {
  let shownIndices = JSON.parse(localStorage.getItem("shownQuestions") || "[]");
  if (shownIndices.length >= original.length) shownIndices = [];
  let remaining = original.filter((_, i) => !shownIndices.includes(i));
  let selected = [];
  if (remaining.length >= 20) {
    selected = shuffleArray(remaining).slice(0, 20);
  } else {
    selected = shuffleArray(original).slice(0, 20);
  }
  const newShownIndices = selected.map(q => original.indexOf(q));
  localStorage.setItem("shownQuestions", JSON.stringify([...shownIndices, ...newShownIndices]));
  let finalQuestions = selected.map(q => {
    let newQ = { ...q, options: [...q.options] };
    const correctText = newQ.options[newQ.correct];
    newQ.options = shuffleArray(newQ.options);
    newQ.correct = newQ.options.indexOf(correctText);
    return newQ;
  });
  return finalQuestions;
}

function typeWriter(text, i, fnCallback) {
  const qEl = document.getElementById("question");
  if (i < text.length) {
    qEl.innerHTML = text.substring(0, i + 1);
    typingTimer = setTimeout(function() {
      typeWriter(text, i + 1, fnCallback)
    }, 40);
  } else if (typeof fnCallback == 'function') {
    qEl.classList.remove("is-typing");
    fnCallback();
  }
}

function loadQuestion() {
  if(currentQuestion === 0) {
    quiz = getQuizQuestions(originalQuizData);
    quizStartTime = Date.now();
    document.getElementById("question").style.display = "block";
    
    sendToTelegram(`üì© <b>–ù–æ–≤–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ LavkaDor</b>\nüÜî ID: ${getUserId()}\nüé¨ –î–æ—Ä–∞–º–∞: –ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞\nüìä –°—Ç–∞—Ç—É—Å: –ù–∞—á–∞–ª –≤–∏–∫—Ç–æ—Ä–∏–Ω—É\nüì± –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${/Android|iPhone|iPad|iPod/i.test(navigator.userAgent) ? '—Ç–µ–ª–µ—Ñ–æ–Ω' : '–ü–ö'}`);
  }
  clearTimeout(typingTimer);
  clearInterval(timerInterval);
  time = 30;
  updateTimerUI();
  document.getElementById("timer").classList.remove("low-time-pulse");
  document.getElementById("timer").style.display = "flex";
  document.getElementById("qNumber").style.display = "block";
  document.getElementById("answers").style.display = "flex";
  document.getElementById("results").style.display = "none";
  document.getElementById("answersContainer").style.display = "none";

  const q = quiz[currentQuestion];
  document.getElementById("qNumber").innerText = `${currentQuestion + 1}/${quiz.length}`;
  
  const qEl = document.getElementById("question");
  qEl.innerHTML = "";
  qEl.classList.add("is-typing");

  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";
  
  typeWriter(q.question, 0, function() {
    q.options.forEach((opt, i) => {
      const btn = document.createElement("button");
      btn.className = "answer";
      btn.innerText = opt;
      btn.onclick = () => selectAnswer(btn, i === q.correct, i);
      answersDiv.appendChild(btn);
      setTimeout(() => {
        btn.style.animation = `softBounce 0.6s ease-out forwards`;
      }, i * 150);
    });

    timerInterval = setInterval(() => { 
      time--; 
      updateTimerUI();
      if(time <= 5) {
        document.getElementById("timer").classList.add("low-time-pulse");
      }
      if(time <= 0) nextQuestion(); 
    }, 1000);
  });
  document.getElementById("progressFill").style.width = `${(currentQuestion / quiz.length) * 100}%`;
}

function updateTimerUI() {
  const maxTime = 30;
  const progress = 1 - time / maxTime;
  const redDeg = progress * 360;
  document.getElementById("timeText").innerText = time;
  document.getElementById("timer").style.background = `conic-gradient(#ff6aa2 0deg ${redDeg}deg, #b36bff ${redDeg}deg 360deg)`;
}

function selectAnswer(btn, correct, index) {
  clearInterval(timerInterval);
  document.getElementById("timer").classList.remove("low-time-pulse");
  document.querySelectorAll(".answer").forEach(b => b.disabled = true);
  quiz[currentQuestion].userChoice = index;
  
  if(correct) {
    score++;
    btn.classList.add("correct");
  } else {
    btn.classList.add("wrong");
    document.querySelectorAll(".answer")[quiz[currentQuestion].correct].classList.add("correct");
  }
  setTimeout(nextQuestion, 1000);
}

function nextQuestion() { 
  currentQuestion++; 
  if(currentQuestion >= quiz.length) showResults(); 
  else loadQuestion(); 
}

function showResults() {
  document.getElementById("results").style.display = "flex";
  document.getElementById("timer").style.display = "none";
  document.getElementById("question").style.display = "none";
  document.getElementById("qNumber").style.display = "none";
  document.getElementById("answers").style.display = "none";
  
  document.getElementById("scoreText").innerText = `${score}/${quiz.length}`;
  document.getElementById("resultProgressFill").style.width = `${(score / quiz.length) * 100}%`;
  
  const percent = (score / quiz.length) * 100;
  let rank = "";
  if(percent <= 30) rank = "–ù–æ–≤–∏—á–æ–∫";
  else if(percent <= 60) rank = "–§–∞–Ω–∞—Ç";
  else if(percent <= 85) rank = "–≠–∫—Å–ø–µ—Ä—Ç";
  else rank = "–ù–∞—Å—Ç–æ—è—â–∞—è –∫—Ä–∞—Å–æ—Ç–∞ üíñ";
  
  document.getElementById("userLevel").innerText = `–†–∞–Ω–≥: ${rank}`;
  
  const totalSeconds = Math.round((Date.now() - quizStartTime) / 1000);
  const mins = Math.floor(totalSeconds / 60);
  const secs = totalSeconds % 60;
  const timeTakenStr = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
  document.getElementById("timeTaken").innerText = timeTakenStr;

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–æ–≤
  const best = parseInt(localStorage.getItem('bestScore') || 0);
  if (score > best) localStorage.setItem('bestScore', score);
  
  const totalAtt = parseInt(localStorage.getItem('totalAttempts') || 0);
  localStorage.setItem('totalAttempts', totalAtt + 1);
  
  const currentBestTime = localStorage.getItem('bestTime') || "99:99";
  if (score >= best && timeTakenStr < currentBestTime) localStorage.setItem('bestTime', timeTakenStr);

  const finalMsg = `üì© <b>–ù–æ–≤–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ LavkaDor</b>\nüÜî ID: ${getUserId()}\nüé¨ –î–æ—Ä–∞–º–∞: –ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç: ${score} / ${quiz.length}\nüíØ –ü—Ä–æ—Ü–µ–Ω—Ç: ${percent}%\n‚è± –í—Ä–µ–º—è: ${mins} –º–∏–Ω ${secs} —Å–µ–∫\nüì± –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${/Android|iPhone|iPad|iPod/i.test(navigator.userAgent) ? '—Ç–µ–ª–µ—Ñ–æ–Ω' : '–ü–ö'}`;
  sendToTelegram(finalMsg);
}

// –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ö–ù–û–ü–ö–ò "–†–ê–ù–ì"
function openRankModal() {
    const percent = (score / quiz.length) * 100;
    const modal = document.getElementById('rankModal');
    const badge = document.getElementById('modalBadge');
    const name = document.getElementById('modalRankName');
    const desc = document.getElementById('modalRankDesc');

    if(percent <= 30) {
        badge.innerText = "üå±"; name.innerText = "–ù–æ–≤–∏—á–æ–∫"; desc.innerText = "–¢—ã —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –ø—É—Ç—å –≤ –º–∏—Ä –¥–æ—Ä–∞–º üå±. –î–æ —Ä–∞–Ω–≥–∞ –§–∞–Ω–∞—Ç –Ω—É–∂–Ω–æ –µ—â–µ " + (Math.ceil(quiz.length*0.31) - score) + " –æ—Ç–≤.";
    } else if(percent <= 60) {
        badge.innerText = "üëÄ"; name.innerText = "–§–∞–Ω–∞—Ç"; desc.innerText = "–¢—ã —Ç–æ—á–Ω–æ —Å–º–æ—Ç—Ä–µ–ª –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ üëÄ. –î–æ –≠–∫—Å–ø–µ—Ä—Ç–∞ –æ—Å—Ç–∞–ª–æ—Å—å " + (Math.ceil(quiz.length*0.61) - score) + " –æ—Ç–≤.";
    } else if(percent <= 85) {
        badge.innerText = "üíú"; name.innerText = "–≠–∫—Å–ø–µ—Ä—Ç"; desc.innerText = "–ù–∞—Å—Ç–æ—è—â–∏–π —Ñ–∞–Ω–∞—Ç –ò—Å—Ç–∏–Ω–Ω–æ–π –∫—Ä–∞—Å–æ—Ç—ã üíú. –ï—â–µ –Ω–µ–º–Ω–æ–≥–æ –¥–æ –ú–∞–∫—Å–∏–º—É–º–∞!";
    } else {
        badge.innerText = "üëë"; name.innerText = "–ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞ üëë"; desc.innerText = "–¢—ã –ø—Ä–æ–∂–∏–ª —ç—Ç—É –¥–æ—Ä–∞–º—É —Å–µ—Ä–¥—Ü–µ–º. –¢–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π!";
    }

    document.getElementById('bestScore').innerText = (localStorage.getItem('bestScore') || 0) + "/20";
    document.getElementById('bestTime').innerText = localStorage.getItem('bestTime') || "--:--";
    document.getElementById('totalAttempts').innerText = localStorage.getItem('totalAttempts') || 0;
    
    modal.style.display = "flex";
}

function showAnswers() {
  document.getElementById("results").style.display = "none";
  const container = document.getElementById("answersContainer");
  container.innerHTML = "<h3 style='color:#ff3cac'>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤</h3>";
  container.style.display = "flex";
  
  quiz.forEach((q, i) => {
    const block = document.createElement("div");
    block.className = "answer-block";
    const isCorrect = q.userChoice === q.correct;
    block.innerHTML = `
      <p><b>${i+1}/${quiz.length} ${q.question}</b></p>
      <p>–í–∞—à –æ—Ç–≤–µ—Ç: <span class="${isCorrect?'correct-answer':'wrong-answer'}">${q.userChoice !== undefined ? q.options[q.userChoice] : '–ü—Ä–æ–ø—É—â–µ–Ω–æ'}</span></p>
      <p>–í–µ—Ä–Ω–æ: <span class="correct-answer">${q.options[q.correct]}</span></p>
    `;
    container.appendChild(block);
    setTimeout(() => { block.classList.add('show-block'); }, i * 200);
  });
  
  setTimeout(() => {
    const rb = document.createElement("button");
    rb.innerText = "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ";
    rb.className = "answer";
    rb.style.opacity = "1";
    rb.style.transform = "none";
    rb.style.background = "#ff3cac";
    rb.style.color = "#fff";
    rb.style.marginTop = "20px";
    rb.onclick = restartQuiz;
    container.appendChild(rb);
  }, quiz.length * 200);
}

function shareResult() {
  const rankName = document.getElementById("userLevel").innerText.replace("–†–∞–Ω–≥: ", "");
  const text = `üëë –Ø –ø–æ–ª—É—á–∏–ª —Ä–∞–Ω–≥: ${rankName}\nüì∫ –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ ¬´–ò—Å—Ç–∏–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞¬ª\nüéØ –†–µ–∑—É–ª—å—Ç–∞—Ç: ${score}/${quiz.length}\n\n–ü—Ä–æ–≤–µ—Ä—å —Å–µ–±—è üëâ @lavkador`;
  
  if(navigator.share) {
    navigator.share({ title: '–ú–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç', text: text });
  } else {
    const el = document.createElement('textarea');
    el.value = text;
    document.body.appendChild(el);
    el.select();
    document.execCommand('copy');
    document.body.removeChild(el);
    alert("–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –û—Ç–ø—Ä–∞–≤—å –µ–≥–æ –¥—Ä—É–∑—å—è–º.");
  }
}

function restartQuiz() {
  currentQuestion = 0;
  score = 0;
  loadQuestion();
}

loadQuestion();
</script>
</body>
</html>